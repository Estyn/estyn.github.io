
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Better Logging in Azure Mobile Services - Estyn's Blog</title>
  <meta name="author" content="Estyn Edwards">

  
  <meta name="description" content="Debugging in azure mobile services can be frustrating, it only runs on Azure servers and you can&rsquo;t run any debugging tools on it. Logging is &hellip;">
  <meta name="keywords" content="azure, tracer,logging,debugging, node, node.js,nodejs">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://Estyn.github.io/blog/2013/12/12/better-logging-in-azure-mobile-services">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Estyn's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43760780-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Estyn's Blog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:Estyn.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Better Logging in Azure Mobile Services</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-12T11:38:00+00:00" pubdate data-updated="true">Dec 12<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Debugging in azure mobile services can be frustrating,  it only runs on Azure servers and you can&rsquo;t run any debugging tools on it.  Logging is pretty much the only way to debug your services. The default logging using console.log is fairly limited.  You can&rsquo;t turn it on or off easily or change the logging level. It also doesn&rsquo;t include the line number which can make it harder to debug a large service.
 <!-- more --></p>

<h2>Installing Tracer</h2>

<p>Fortunately there are some excellent node modules for logging that work fairly well with Azure Mobile Services. I&rsquo;m using the excellent <a href="https://github.com/baryon/tracer">tracer</a> module.</p>

<p>Installing the module is fairly straight forward, you will first need to <a href="http://www.windowsazure.com/en-us/develop/mobile/tutorials/store-scripts-in-source-control/">setup git access</a>. You then need to install the trace module.</p>

<pre><code>npm install tracer
</code></pre>

<p>Once you have the the module installed you can use it in your scripts.</p>

<pre><code>var logger = require('tracer').console();
logger.log('hello');
logger.trace('hello', 'world');
logger.debug('hello %s',  'world', 123);
logger.info('hello %s %d',  'world', 123, {foo:'bar'});
logger.warn('hello %s %d %j', 'world', 123, {foo:'bar'});
logger.error('hello %s %d %j', 'world', 123, {foo:'bar'}, [1, 2, 3, 4], Object);
</code></pre>

<p>When you use the the logger it will include the line number as well as the logging level.</p>

<h2>Setting the Logging Level</h2>

<p>You can set the logging level fairly simply:</p>

<pre><code>var logger = require('tracer').colorConsole({level:'warn'});
</code></pre>

<p>An even better way to do it is to use an app setting to set the logging level.  That way you can use azure portal to set the logging level without having to change any of the scripts.</p>

<pre><code>var logger = require('tracer').colorConsole({level:process.env.LoggerLevel});
</code></pre>

<h2>Using Colour and Log Watcher</h2>

<p>The web view of the logs isn&rsquo;t very useful for logging, instead I use a <a href="http://www.thejoyofcode.com/A_Mobile_Services_Log_Watcher_Day_6_.aspx">node.js script</a> from Josh Twist that polls the logs from the api. This allows you to see the errors as they happened and stops you from having to refresh a web page manually.</p>

<p>As an additional bonus you can use colours when you are using the script. This makes it much easier to keep things organized.</p>

<pre><code>var _ = require('lodash');
var colors = require('colors');
var logger = require('tracer').colorConsole({filters : {
    log : colors.white,
    trace : colors.grey,
    debug : colors.magenta,
    info : colors.green,
    warn : colors.yellow,
    error : [ colors.red, colors.bold ]
},
level:process.env.LoggerLevel //log,trace,debug,info,warn,error

});
</code></pre>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Estyn Edwards</span></span>

      








  


<time datetime="2013-12-12T11:38:00+00:00" pubdate data-updated="true">Dec 12<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/azure/'>Azure</a>, <a class='category' href='/blog/categories/azure-mobile-services/'>Azure Mobile Services</a>, <a class='category' href='/blog/categories/node/'>Node</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://Estyn.github.io/blog/2013/12/12/better-logging-in-azure-mobile-services/" data-via="" data-counturl="http://Estyn.github.io/blog/2013/12/12/better-logging-in-azure-mobile-services/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/09/06/azure-dev-machine-auto-shutdown-part-2/" title="Previous Post: Azure Dev Machine Auto Shutdown Part 2">&laquo; Azure Dev Machine Auto Shutdown Part 2</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/12/better-logging-in-azure-mobile-services/">Better Logging in Azure Mobile Services</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/06/azure-dev-machine-auto-shutdown-part-2/">Azure Dev Machine Auto Shutdown Part 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/03/auto-shutdown-for-windows-azure-vm/">Auto Shutdown for Windows Azure VM</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Estyn Edwards -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'estyn';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://Estyn.github.io/blog/2013/12/12/better-logging-in-azure-mobile-services/';
        var disqus_url = 'http://Estyn.github.io/blog/2013/12/12/better-logging-in-azure-mobile-services/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
